<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Eiffel-remrem-generate : eiffel-remrem-generate">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Eiffel-remrem-generate</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ericsson/eiffel-remrem-generate">View on GitHub</a>

          <h1 id="project_title">Eiffel RemRem Generate Service</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/ericsson/eiffel-remrem-generate/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/ericsson/eiffel-remrem-generate/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>
<a id="compatibility" class="anchor" href="#compatibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Compatibility</h2>

<ul>
<li>JDK 8</li>
<li>Tomcat 7</li>
</ul>

<h2>
<a id="the-releases" class="anchor" href="#the-releases" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The releases</h2>

<p>Binary is relased via <a href="https://jitpack.io/#Ericsson/eiffel-remrem-generate">jitPack</a>.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p><pre><code>$ java -jar eiffel-remrem-generate-&lt;version&gt;.war</code></pre><br>
or deploy it in tomcat</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<ul><li>url: hostname/eiffelsemantics?msgType=&lt;message type&gt;</li>
<li>message type should be one of the following: eiffelartifactpublished, eiffelactivityfinished</li>
<li>use POST method</li>
<li>body: please follow <a href="https://github.com/Ericsson/eiffel/tree/master/eiffel-syntax-and-usage">eiffel syntax</a> and <a href="https://github.com/Ericsson/eiffel/tree/master/eiffel-vocabulary">eiffel vocabulary</a></li></ul>

<h2>
<a id="testing" class="anchor" href="#testing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Testing</h2>

<p><h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h4>
<pre><code>$ curl -H "Content-Type: application/json" -X POST -d '
  {"msgParams": {
  "meta": {
    "type": "EiffelActivityFinishedEvent",
    "domainId": "example.domain",
    "tags": ["tag1", "tag2"],
    "source": {
      "host": "host",
      "name": "name",
      "uri": "<a href="http://java.sun.com/j2se/1.3/">http://java.sun.com/j2se/1.3/</a>",
      "serializer": {
        "groupId": "G",
        "artifactId": "A",
        "version": "V"
      }
    }
  }
},
  "eventParams": {
    "data": {
      "outcome": {
        "conclusion": "TIMED_OUT",
        "description": "Compilation timed out."
      },
      "persistentLogs": [
        {
          "name": "firstLog",
          "uri": "<a href="http://myHost.com/firstLog">http://myHost.com/firstLog</a>"
        },
        {
          "name": "otherLog",
          "uri": "isbn:0-486-27557-4"
        }
      ]
    },
    "links": {
      "activityExecution": "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeee1",
      "causes": ["cause1", "cause2"],
      "flowContext": "flowContext"
    }
  }
}' http://localhost:8080/eiffelsemantics?msgType=eiffelactivityfinished</code></pre>
<br><br>
<pre><code>$ curl -H "Content-Type: application/json" -X POST -d '
{"msgParams": {
  "meta": {
    "type": "EiffelArtifactPublishedEvent",
    "domainId": "example.domain",
    "tags": ["tag1", "tag2"],
    "source": {
      "host": "host",
      "name": "name",
      "uri": "http://java.sun.com/j2se/1.3/",
      "serializer": {
        "groupId": "G",
        "artifactId": "A",
        "version": "V"
      }
    }
  }
},
  "eventParams": {
    "data": {
      "locations": [
        {
          "type": "ARTIFACTORY",
          "uri": "https://one.place"
        },
        {
          "type": "PLAIN",
          "uri": "http://another.com"
        }
      ]
    },
    "links": {
      "context": "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeee1",
      "artifact": "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeee2"
    }
  }
}
' http://localhost:8080/eiffelsemantics?msgType=eiffelartifactpublished</code></pre></p>

<h2>
<a id="exceptions" class="anchor" href="#exceptions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Exceptions</h2>

<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Invalid Json</h4>
response
<pre><code>{
  "timestamp": "Jun 1, 2016 2:40:10 PM",
  "status": 400,
  "error": "Bad Request",
  "exception": "org.springframework.http.converter.HttpMessageNotReadableException",
  "message": "Could not read JSON: com.google.gson.stream.MalformedJsonException: Unterminated object at line 28 column 12 path $.eventParams.data.persistentLogs[0].name; nested exception is com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Unterminated object at line 28 column 12 path $.eventParams.data.persistentLogs[0].name",
  "path": "/eiffelsemantics"
}
</code></pre>
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Incorrect Eiffel Syntax</h4>
<p>Example: event missing links<br>
input event
<pre><code>{
"msgParams": {
  "meta": {
    "type": "EiffelActivityFinishedEvent",
    "domainId": "example.domain",
    "tags": ["tag1", "tag2"],
    "source": {
      "host": "host",
      "name": "name",
      "uri": "http://java.sun.com/j2se/1.3/",
      "serializer": {
        "groupId": "G",
        "artifactId": "A",
        "version": "V"
      }
    }
  }
},
  "eventParams": {
    "data": {
      "outcome": {
        "conclusion": "TIMED_OUT",
        "description": "Compilation timed out."
      },
      "persistentLogs": [
        {
          "name": "firstLog",
          "uri": "http://myHost.com/firstLog"
        },
        {
          "name": "otherLog",
          "uri": "isbn:0-486-27557-4"
        }
      ]
    }
  }
}
</code></pre>
response
<pre><code>{
{
  "message": "Cannot validate given JSON string",
  "cause": "com.ericsson.eiffel.remrem.semantics.validator.EiffelValidationException: com.github.fge.jsonschema.core.report.ListProcessingReport: failure--- BEGIN MESSAGES ---error: object has missing required properties <mark>([\"links\"])</mark>    level: \"error\"    schema: {\"loadingURI\":\"#\",\"pointer\":\"\"}    instance: {\"pointer\":\"\"}    domain: \"validation\"    keyword: \"required\"    required: [\"data\",\"links\",\"meta\"]    missing: [\"links\"]---  END MESSAGES  ---"
}
</code></pre>

</p>
</ul>
</p>

<h2>
<a id="performance" class="anchor" href="#performance" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Performance</h2>
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>500 requests per sec</h4>
<p>The service can respond to 500 requests per second</p>
<p>
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1CPU 100 users 10 mins</h4>
<img src="images/1CPU___100_users___10_min.png">
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1CPU 250 users 10 mins</h4>
<img src="images/1CPU___250_users___10_min.png">
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2CPU 500 users 10 mins</h4>
<img src="images/2CPU___500_users___10_min.png">
<h4><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>VisualVM memory/CPU utilization report (2 CPUs, 500 users/sec)</h4>
<img src="images/VisualVM___2CPU___500_users___10_min.jpg">
</p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Eiffel-remrem-generate maintained by <a href="https://github.com/ericsson">Ericsson</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
